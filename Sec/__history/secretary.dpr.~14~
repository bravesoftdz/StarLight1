program secretary;

uses
  Forms,
  Windows,
  SysUtils,
  Dialogs,
  Classes,
  UClientOrder in 'UClientOrder.pas' {frmClientOrders};

{$R *.res}
VAR
  i, DeptID: Integer;
  print, delete, edit, Addit: boolean;
  ora_db_path : string;
  username, password : string;

begin


if ParamCount < 4 then Exit; // логин пароль и путь к базе и отдел, а остальное
  Username := '0';
  Password := '0';

  // возможно и не нужно:
  Edit := false;
  Delete := false;
  Print := false;
  Addit := false;

  for i := 1 to ParamCount do
  begin
    // Логин
    if LowerCase(ParamStr(i)) = '-l' then
      if ParamCount >= i+1 then
        Begin
          username := AnsiLowerCase(ParamStr(i+1));
        End
    else
      Begin
        ShowMessage('Ошибка параметров!');
        Exit;
      End;

    // Пароль
    if LowerCase(ParamStr(i)) = '-p' then
      if ParamCount >= i+1 then
        Begin
          Password := AnsiLowerCase(ParamStr(i+1));
        End
    else
      Begin
        ShowMessage('Ошибка параметров!');
        Exit;
      End;

    // Путь к БД
    if LowerCase(ParamStr(i)) = '-d' then
      if ParamCount >= i+1 then
        Begin
          ora_db_path := AnsiLowerCase(ParamStr(i+1));
        End
    else
      Begin
        ShowMessage('Ошибка параметров!');
        Exit;
      End;

    // Отдел
    if LowerCase(ParamStr(i)) = '-otd' then
      if ParamCount >= i+1 then
        Begin
          DeptID := StrToInt(AnsiLowerCase(ParamStr(i+1)));
        End
    else
      Begin
        ShowMessage('Ошибка параметров!');
        Exit;
      End;

    // Редактирование
    if LowerCase(ParamStr(i)) = '-e' then edit := true;
    // Удаление
    if LowerCase(ParamStr(i)) = '-k' then delete := true;
    // Печать
    if LowerCase(ParamStr(i)) = '-t' then print := true;
    // Дополнительно
    if LowerCase(ParamStr(i)) = '-a' then addit := true;
  end;

  Application.Initialize;
  Application.MainFormOnTaskbar := True;
  Application.Title := 'НОВАЯ Печать клиентских заказов';


  Application.CreateForm(TfrmClientOrders, frmClientOrders);
   // возможно и не нужно
  {frmClientOrders.edit := edit;
  frmClientOrders.delete := delete;
  frmClientOrders.print := print;
  frmClientOrders.addit := addit;


  frmClientOrders.Main_session.Username := username;
  frmClientOrders.Main_session.Password := Password;
  frmClientOrders.Main_session.Server := ora_db_path;
  frmClientOrders.DeptID := DeptID;
  frmClientOrders.Main_session.Connect;

  }


  Application.Run;


end.
