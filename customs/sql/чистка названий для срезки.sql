select ''''||name_code||''',',count(1) from flower_names a
where a.id_departments = 62
GROUP by name_code having count(*) > 1
;

select count(1) from nomenclature_mat_view a where a.id_departments = 62
;

select count(1) from flower_names a, nomenclature_mat_view b
where a.fn_id = b.fn_id and a.name_code in (
'16286', 
'16091', 
'15359', 
'583',   
'178',   
'728',       
'18599', 
'14549', 
'19739', 
'874',   
'725',   
'534',   
'4077',  
'2030',  
'932',   
'18594', 
'26774', 
'1303',  
'61',    
'101435',
'1309',  
'1383',  
'1872',  
'3322',  
'22881', 
'209',   
'129',   
'2243',  
'2287',  
'12157', 
'576',   
'13400', 
'192',   
'599',   
'1931',  
'17590', 
'11390', 
'223',   
'15624', 
'17',    
'2396',  
'3260',  
'191',   
'19762', 
'13027', 
'312',   
'319',   
'326',   
'286',   
'18977', 
'4425',  
'321',   
'574',   
'16324', 
'18598', 
'489',   
'837',   
'200',   
'3372',  
'1221',  
'933',   
'514',   
'366',   
'10439', 
'961',   
'23720', 
'311',   
'1860',  
'27336', 
'21878', 
'22502', 
'2166',  
'211',   
'221',   
'24101', 
'1378',  
'1506',  
'2574',  
'20376', 
'2239',  
'426',   
'18368', 
'1234',  
'18011', 
'10378', 
'1030',  
'5503',  
'162',   
'2458',  
'198',   
'1433',  
'582',   
'7687',  
'1272',  
'1705',  
'2617',  
'117',   
'1264',  
'1299',  
'27498', 
'295',   
'1033',  
'1581',  
'365',   
'580',   
'3507',  
'1999',  
'194',   
'315',   
'2489',  
'335',   
'1677',  
'536',   
'244',   
'20885', 
'19887', 
'910',   
'90',    
'18633', 
'964',   
'202',   
'213',   
'28543', 
'18631', 
'17075', 
'16207', 
'364',   
'17126', 
'341',   
'17395', 
'973',   
'316',   
'164',   
'327',   
'196',   
'595',   
'745',   
'1230',  
'275',   
'15693', 
'586',   
'10836', 
'917',   
'1962',  
'703',   
'60',    
'15337', 
'1752',  
'1286',  
'1719',  
'2361',  
'6231',  
'17409', 
'955',   
'18058', 
'11207'
);
--order by a.name_code


delete from nomenclature a where a.fn_id in (select fn_id from flower_names where name_code in (
'16286', 
'16091', 
'15359', 
'583',   
'178',   
'728',       
'18599', 
'14549', 
'19739', 
'874',   
'725',   
'534',   
'4077',  
'2030',  
'932',   
'18594', 
'26774', 
'1303',  
'61',    
'101435',
'1309',  
'1383',  
'1872',  
'3322',  
'22881', 
'209',   
'129',   
'2243',  
'2287',  
'12157', 
'576',   
'13400', 
'192',   
'599',   
'1931',  
'17590', 
'11390', 
'223',   
'15624', 
'17',    
'2396',  
'3260',  
'191',   
'19762', 
'13027', 
'312',   
'319',   
'326',   
'286',   
'18977', 
'4425',  
'321',   
'574',   
'16324', 
'18598', 
'489',   
'837',   
'200',   
'3372',  
'1221',  
'933',   
'514',   
'366',   
'10439', 
'961',   
'23720', 
'311',   
'1860',  
'27336', 
'21878', 
'22502', 
'2166',  
'211',   
'221',   
'24101', 
'1378',  
'1506',  
'2574',  
'20376', 
'2239',  
'426',   
'18368', 
'1234',  
'18011', 
'10378', 
'1030',  
'5503',  
'162',   
'2458',  
'198',   
'1433',  
'582',   
'7687',  
'1272',  
'1705',  
'2617',  
'117',   
'1264',  
'1299',  
'27498', 
'295',   
'1033',  
'1581',  
'365',   
'580',   
'3507',  
'1999',  
'194',   
'315',   
'2489',  
'335',   
'1677',  
'536',   
'244',   
'20885', 
'19887', 
'910',   
'90',    
'18633', 
'964',   
'202',   
'213',   
'28543', 
'18631', 
'17075', 
'16207', 
'364',   
'17126', 
'341',   
'17395', 
'973',   
'316',   
'164',   
'327',   
'196',   
'595',   
'745',   
'1230',  
'275',   
'15693', 
'586',   
'10836', 
'917',   
'1962',  
'703',   
'60',    
'15337', 
'1752',  
'1286',  
'1719',  
'2361',  
'6231',  
'17409', 
'955',   
'18058', 
'11207'
));




delete from flower_names where name_code in (
'16286', 
'16091', 
'15359', 
'583',   
'178',   
'728',       
'18599', 
'14549', 
'19739', 
'874',   
'725',   
'534',   
'4077',  
'2030',  
'932',   
'18594', 
'26774', 
'1303',  
'61',    
'101435',
'1309',  
'1383',  
'1872',  
'3322',  
'22881', 
'209',   
'129',   
'2243',  
'2287',  
'12157', 
'576',   
'13400', 
'192',   
'599',   
'1931',  
'17590', 
'11390', 
'223',   
'15624', 
'17',    
'2396',  
'3260',  
'191',   
'19762', 
'13027', 
'312',   
'319',   
'326',   
'286',   
'18977', 
'4425',  
'321',   
'574',   
'16324', 
'18598', 
'489',   
'837',   
'200',   
'3372',  
'1221',  
'933',   
'514',   
'366',   
'10439', 
'961',   
'23720', 
'311',   
'1860',  
'27336', 
'21878', 
'22502', 
'2166',  
'211',   
'221',   
'24101', 
'1378',  
'1506',  
'2574',  
'20376', 
'2239',  
'426',   
'18368', 
'1234',  
'18011', 
'10378', 
'1030',  
'5503',  
'162',   
'2458',  
'198',   
'1433',  
'582',   
'7687',  
'1272',  
'1705',  
'2617',  
'117',   
'1264',  
'1299',  
'27498', 
'295',   
'1033',  
'1581',  
'365',   
'580',   
'3507',  
'1999',  
'194',   
'315',   
'2489',  
'335',   
'1677',  
'536',   
'244',   
'20885', 
'19887', 
'910',   
'90',    
'18633', 
'964',   
'202',   
'213',   
'28543', 
'18631', 
'17075', 
'16207', 
'364',   
'17126', 
'341',   
'17395', 
'973',   
'316',   
'164',   
'327',   
'196',   
'595',   
'745',   
'1230',  
'275',   
'15693', 
'586',   
'10836', 
'917',   
'1962',  
'703',   
'60',    
'15337', 
'1752',  
'1286',  
'1719',  
'2361',  
'6231',  
'17409', 
'955',   
'18058', 
'11207'
);

delete from flower_name_translations a where a.fn_id not in (select fn_id from flower_names)
--delete from flower_names where fn_id in (2961,573 ,1324,321 ,1039,1353,1484,1513,2940,1326)
